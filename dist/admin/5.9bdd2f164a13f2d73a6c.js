(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"+P1L":function(e,t,i){"use strict";i.r(t),i.d(t,"UsersModule",(function(){return A}));var s=i("ofXK"),a=i("tyNb"),r=i("fXoL"),n=i("Wp6s"),o=i("wZkO"),c=i("IzEk"),l=i("3Pt+"),u=i("QCfB"),d=i("ks/5");function p(e,t){if(1&e){const e=r.Vb();r.Ub(0,"mvd-dinamic-form",1),r.bc("value",(function(t){return r.tc(e),r.fc().dataSubmit(t)})),r.Tb()}if(2&e){const e=r.fc();r.lc("fields",e.fields)}}let b=(()=>{class e{constructor(e,t,i){this.userService=e,this.router=t,this.location=i,this.subcriptions=[]}ngOnInit(){this.typesDocIden=[{name:"D.N.I.",value:"D.N.I."},{name:"Pasaporte",value:"Pasaporte"}],this.idUser?this.getUser(this.idUser):this.setFields()}getUser(e){this.subcriptions.push(this.userService.getUser(e).subscribe(e=>{console.log(e),this.userEdit=e,this.setFields()}))}setFields(){var e,t,i,s,a,r,n,o,c,u,d,p,b,h,m,v,g,f,U,y;this.fields=[{nameControl:"id",type:"hidden",value:null===(e=this.userEdit)||void 0===e?void 0:e.id,label:"Id"},{nameControl:"image",type:"image",value:null===(i=null===(t=this.userEdit)||void 0===t?void 0:t.account)||void 0===i?void 0:i.image,label:"Imagen"},{nameControl:"name",type:"text",value:null===(s=this.userEdit)||void 0===s?void 0:s.name,label:"Nombre",validators:[l.u.required]},{nameControl:"last_name",type:"text",value:null===(a=this.userEdit)||void 0===a?void 0:a.last_name,label:"Apellido",validators:[l.u.required]},{nameControl:"type_doc_iden",type:"select",value:null===(n=null===(r=this.userEdit)||void 0===r?void 0:r.account)||void 0===n?void 0:n.type_doc_iden,label:"Tipo documento de identidad",options:this.typesDocIden,validators:[l.u.required]},{nameControl:"dni",type:"text",value:null===(c=null===(o=this.userEdit)||void 0===o?void 0:o.account)||void 0===c?void 0:c.dni,label:"N\xba documento",validators:[l.u.required]},{nameControl:"email",type:"text",value:null===(u=this.userEdit)||void 0===u?void 0:u.email,label:"Email",validators:[l.u.required]},{nameControl:"address",type:"text",value:null===(p=null===(d=this.userEdit)||void 0===d?void 0:d.account)||void 0===p?void 0:p.address,label:"Direcci\xf3n"},{nameControl:"phone",type:"text",value:null===(h=null===(b=this.userEdit)||void 0===b?void 0:b.account)||void 0===h?void 0:h.phone,label:"Tel\xe9fono",validators:[l.u.required]},{nameControl:"movil",type:"text",value:null===(v=null===(m=this.userEdit)||void 0===m?void 0:m.account)||void 0===v?void 0:v.movil,label:"Celular"},{nameControl:"company",type:"text",value:null===(f=null===(g=this.userEdit)||void 0===g?void 0:g.account)||void 0===f?void 0:f.company,label:"Empresa (si corresponde)"},{nameControl:"cuit",type:"text",value:null===(y=null===(U=this.userEdit)||void 0===U?void 0:U.account)||void 0===y?void 0:y.cuit,label:"CUIT (si corresponde)"}]}dataSubmit(e){console.log(e);const t=e;this.userEdit?this.updateUser(t):this.addUser(t)}addUser(e){this.userService.storeUser(e).pipe(Object(c.a)(1)).subscribe(e=>{console.log(e),this.location.back()})}updateUser(e){this.userService.updateUser(e).pipe(Object(c.a)(1)).subscribe(e=>{console.log(e),this.location.back()})}deleteUser(e){this.subcriptions.push(this.userService.deleteUser(e).subscribe(e=>this.router.navigate([this.urlReturn])))}ngOnDestroy(){this.subcriptions.map(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(r.Ob(u.a),r.Ob(a.b),r.Ob(s.h))},e.\u0275cmp=r.Ib({type:e,selectors:[["mvd-form-user"]],inputs:{idUser:"idUser"},decls:1,vars:1,consts:[[3,"fields","value",4,"ngIf"],[3,"fields","value"]],template:function(e,t){1&e&&r.Bc(0,p,1,1,"mvd-dinamic-form",0),2&e&&r.lc("ngIf",t.fields)},directives:[s.l,d.a],styles:[""]}),e})();var h=i("M9IT"),m=i("lJxs"),v=i("GH7h"),g=i("TuB2"),f=i("0IaG"),U=i("XpUC"),y=i("uDhH"),C=i("bTqV"),T=i("NFeN"),D=i("JhQZ"),S=i("lkLn");function x(e,t){if(1&e){const e=r.Vb();r.Ub(0,"mvd-data-table",10),r.bc("actionChange",(function(t){return r.tc(e),r.fc(3).itemAction(t)})),r.gc(1,"async"),r.Tb()}if(2&e){const e=r.fc(3);r.lc("columns",e.columns)("dataSource",r.hc(1,2,e.dataSource))}}const I=function(){return[20,50,100]};function O(e,t){if(1&e){const e=r.Vb();r.Sb(0),r.Ub(1,"div",3),r.Ub(2,"button",4),r.bc("click",(function(){return r.tc(e),r.fc(2).openDialog()})),r.Ub(3,"mat-icon",5),r.Dc(4,"add"),r.Tb(),r.Dc(5," Crear "),r.Tb(),r.Ub(6,"button",6),r.Ub(7,"mat-icon",5),r.Dc(8,"print"),r.Tb(),r.Dc(9," Imprimir "),r.Tb(),r.Ub(10,"button",6),r.Ub(11,"mat-icon",5),r.Dc(12,"save_alt"),r.Tb(),r.Dc(13," Exportar "),r.Tb(),r.Tb(),r.Ub(14,"mvd-input-search",7),r.bc("changeSearch",(function(t){return r.tc(e),r.fc(2).search(t)})),r.Tb(),r.Bc(15,x,2,4,"mvd-data-table",8),r.Ub(16,"mat-paginator",9),r.bc("page",(function(t){return r.tc(e),r.fc(2).paginatorChange(t)})),r.gc(17,"async"),r.Tb(),r.Rb()}if(2&e){const e=r.fc(2);r.Cb(14),r.lc("noteFilterBy","Filtra m\xfaltiples campos"),r.Cb(1),r.lc("ngIf",e.dataSource),r.Cb(1),r.lc("length",r.hc(17,5,e.totalResut))("pageSize",e.perPage)("pageSizeOptions",r.mc(7,I))}}function E(e,t){if(1&e&&(r.Sb(0),r.Bc(1,O,18,8,"ng-container",0),r.Rb()),2&e){const e=r.fc(),t=r.qc(4);r.Cb(1),r.lc("ngIf",e.propertiesUser.length>=1)("ngIfElse",t)}}function _(e,t){1&e&&(r.Ub(0,"h3"),r.Dc(1,"A\xfan no existe el usuario"),r.Tb(),r.Ub(2,"ul"),r.Ub(3,"li"),r.Dc(4,"1) Termine de crear el usuario"),r.Tb(),r.Ub(5,"li"),r.Dc(6,"2) Asigne propiedades al usuario: "),r.Ub(7,"ul"),r.Ub(8,"li"),r.Dc(9,"OPCION 1. Cree o actualice una propiedad con este usuario como propietario"),r.Tb(),r.Ub(10,"li"),r.Dc(11,"OPCION 2. Cree una transacci\xf3n con este usuario como cliente (arrendatario o comprador)"),r.Tb(),r.Tb(),r.Tb(),r.Tb())}function P(e,t){1&e&&(r.Ub(0,"h3"),r.Dc(1,"A\xfan no tiene propiedades asignadas"),r.Tb(),r.Ub(2,"h4"),r.Dc(3,"Asignar al menos una propiedad: "),r.Tb(),r.Ub(4,"ul"),r.Ub(5,"li"),r.Dc(6,"Asignar propiedades al usuario: "),r.Ub(7,"ul"),r.Ub(8,"li"),r.Dc(9,"OPCION 1. Cree o actualice una propiedad con este usuario como propietario"),r.Tb(),r.Ub(10,"li"),r.Dc(11,"OPCION 2. Cree una transacci\xf3n con este usuario como cliente (arrendatario o comprador)"),r.Tb(),r.Tb(),r.Tb(),r.Tb())}let w=(()=>{class e{constructor(e,t,i,s,a,r){this.userService=e,this.router=t,this.expenseService=i,this.dialog=s,this.currencyService=a,this.productService=r,this.columns=[{title:"ID",col:"id"},{title:"Fecha",col:"created_at",pipe:"dd/MM/yyyy"},{title:"Tipo de Gasto",col:"expense_name"},{title:"Propiedad",col:"property"},{title:"Valor",col:"value_currency"}],this.pageDefault=1,this.perPage=10,this.orden="desc",this.filter="",this.subscroptions=[],this.propertiesUser=[],this.result=this.expenseService.resultItems$}paginatorChange(e){console.log(e),this.getExpensesUser(e.pageIndex+1,e.pageSize)}ngOnInit(){this.expenseService.getExpenses(1,1e4).pipe(Object(m.a)(e=>e.data.data.map(e=>({name:e.name,value:e.id}))),Object(c.a)(1)).subscribe(e=>this.optionsTypesExpense=e),this.subscroptions.push(this.currencyService.getCurrencies().pipe(Object(m.a)(e=>e.map(e=>({name:e.symbol,value:e.id})))).subscribe(e=>this.currencies=e),this.userService.userOnEdit.subscribe(e=>{this.userEdit=e,this.userEdit&&(this.expenseService.setUserEdit(this.userEdit.id),this.subscroptions.push(this.productService.getProductsUser(this.userEdit.id).pipe(Object(m.a)(e=>e.map(e=>({name:e.title,value:e.id})))).subscribe(e=>{this.propertiesUser=e,console.log(this.propertiesUser)})),this.getExpensesUser(this.pageDefault,this.perPage,this.filter,this.orden))})),this.router.url.split("/"),this.title="Usuarios del Sistema"}getExpensesUser(e,t,i,s){this.subscroptions.push(this.expenseService.getExpensesUser(e,t,i,s).subscribe(e=>this.loadData()))}loadData(){this.dataSource=this.result.pipe(Object(m.a)(e=>e.data.data.map(e=>({id:e.id,expense_id:e.expense_id,expense_name:e.expense.name,created_at:e.created_at,property_id:e.property_id,property:e.property.title,currency_id:e.currency_id,currency:e.currency.symbol,user_id:e.user_id,value:e.value,value_currency:`${e.currency.symbol} ${e.value}`})))),this.totalResut=this.result.pipe(Object(m.a)(e=>e.data.total))}search(e){this.getExpensesUser(this.pageDefault,this.perPage,e,this.orden)}deleteItem(e){return this.expenseService.deleteExpenseUser(e)}itemAction(e){console.log(e),"delete"===e.action&&this.deleteItem(e.element.id).pipe(Object(c.a)(1)).subscribe(e=>console.log(e)),"edit"===e.action&&this.openDialog(e.element)}openDialog(e){return this.dialog.open(v.a,{width:"850px",data:this.setFields(e)}).afterClosed().subscribe(e=>{e&&(e.id?(this.updateExpenseUser(e),console.log(e)):(console.log(e),this.storeExpenseUser(e)))})}updateExpenseUser(e){this.expenseService.updateExpensePrpertyUser(e).pipe(Object(c.a)(1)).subscribe()}storeExpenseUser(e){this.expenseService.storeExpensePrpertyUser(e).pipe(Object(c.a)(1)).subscribe()}setFields(e){return console.log(e),[{nameControl:"id",type:"hidden",value:null==e?void 0:e.id,label:"Id"},{nameControl:"user_id",type:"hidden",value:this.userEdit.id,label:"User ID"},{nameControl:"expense_id",type:"select",value:null==e?void 0:e.expense_id,label:"Tipo de Gasto",options:this.optionsTypesExpense,validators:[l.u.required]},{nameControl:"property_id",type:"select-mvd-col1--1",value:null==e?void 0:e.property_id,label:"Propiedad",options:this.propertiesUser,validators:[l.u.required]},{nameControl:"currency_id",type:"select",value:null==e?void 0:e.currency_id,label:"Moneda",options:this.currencies,validators:[l.u.required]},{nameControl:"value",type:"text",value:null==e?void 0:e.value,label:"Valor",validators:[l.u.required]}]}ngOnDestroy(){this.subscroptions.map(e=>e.unsubscribe())}}return e.\u0275fac=function(t){return new(t||e)(r.Ob(u.a),r.Ob(a.b),r.Ob(g.a),r.Ob(f.b),r.Ob(U.a),r.Ob(y.a))},e.\u0275cmp=r.Ib({type:e,selectors:[["mvd-expenses"]],viewQuery:function(e,t){var i;1&e&&r.xc(h.a,!0),2&e&&r.pc(i=r.cc())&&(t.paginator=i.first)},decls:5,vars:2,consts:[[4,"ngIf","ngIfElse"],["userNotFound",""],["sinPropiedades",""],[1,"actions"],["mat-flat-button","","color","primary",3,"click"],[1,"material-icons-round"],["mat-flat-button","","routerLink","/","color","",1,"btn-simple"],[3,"noteFilterBy","changeSearch"],[3,"columns","dataSource","actionChange",4,"ngIf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[3,"columns","dataSource","actionChange"]],template:function(e,t){if(1&e&&(r.Bc(0,E,2,2,"ng-container",0),r.Bc(1,_,12,0,"ng-template",null,1,r.Cc),r.Bc(3,P,12,0,"ng-template",null,2,r.Cc)),2&e){const e=r.qc(2);r.lc("ngIf",t.userEdit)("ngIfElse",e)}},directives:[s.l,C.b,T.a,a.c,D.a,h.a,S.a],pipes:[s.b],styles:["ul[_ngcontent-%COMP%]{padding:10px!important}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none}"]}),e})();function j(e,t){1&e&&(r.Ub(0,"div",7),r.Ub(1,"div",8),r.Pb(2,"div"),r.Pb(3,"div"),r.Pb(4,"div"),r.Tb(),r.Tb())}let F=(()=>{class e{constructor(e){this.activateRouter=e}ngOnInit(){this.loadData()}loadData(){this.activateRouter.paramMap.subscribe(e=>{e.params.id&&(this.id=e.params.id)})}}return e.\u0275fac=function(t){return new(t||e)(r.Ob(a.a))},e.\u0275cmp=r.Ib({type:e,selectors:[["mvd-user"]],decls:15,vars:1,consts:[[1,"card","mat-elevation-z16","animate__animated","animate__slideInRight"],["mat-stretch-tabs","",1,""],["label","Datos de Usuario"],[3,"idUser"],["label","Gastos"],["loading",""],[1,"border"],[1,"div-content"],[1,"loading"]],template:function(e,t){1&e&&(r.Ub(0,"mat-card",0),r.Ub(1,"mat-card-header"),r.Ub(2,"mat-card-title"),r.Dc(3,"Usuarios"),r.Tb(),r.Ub(4,"mat-card-subtitle"),r.Dc(5,"Detalles del usuario "),r.Tb(),r.Tb(),r.Sb(6),r.Ub(7,"mat-tab-group",1),r.Ub(8,"mat-tab",2),r.Pb(9,"mvd-form-user",3),r.Tb(),r.Ub(10,"mat-tab",4),r.Pb(11,"mvd-expenses"),r.Tb(),r.Tb(),r.Rb(),r.Bc(12,j,5,0,"ng-template",null,5,r.Cc),r.Pb(14,"span",6),r.Tb()),2&e&&(r.Cb(9),r.lc("idUser",t.id))},directives:[n.a,n.c,n.f,n.e,o.b,o.a,b,w],styles:[""]}),e})();const k=function(){return[20,50,100]},B=[{path:"usuario/:id",component:F},{path:"usuario",component:F},{path:"",component:(()=>{class e{constructor(e,t){this.userService=e,this.router=t,this.columns=[{title:"ID",col:"id"},{title:"Nombre",col:"name"},{title:"Email",col:"email"},{title:"Tel\xe9fonos ",col:"phone"}],this.pageDefault=1,this.perPage=10,this.orden="desc",this.filter="",this.result=this.userService.resultItems$}paginatorChange(e){console.log(e),this.getUsers(e.pageIndex+1,e.pageSize)}ngOnInit(){const e=this.router.url.split("/")[1];if("clientes"===e){let e="USER";this.title="Clientes",this.getUsers(this.pageDefault,this.perPage,e,this.orden)}if("usuarios"===e){let e="ADMIN";this.title="Usuarios del Sistema",this.getUsers(this.pageDefault,this.perPage,e,this.orden)}}getUsers(e,t,i,s){this.subscroption=this.userService.getUsers(e,t,i,s).subscribe(e=>this.loadData())}loadData(){this.dataSource=this.result.pipe(Object(m.a)(e=>e.data.data.map(e=>{var t,i;return{id:e.id,name:`${e.name} ${e.last_name}`,email:e.email,phone:`${null===(t=e.account)||void 0===t?void 0:t.phone} / ${null===(i=e.account)||void 0===i?void 0:i.movil}`}}))),this.totalResut=this.result.pipe(Object(m.a)(e=>e.data.total))}search(e){this.getUsers(this.pageDefault,this.perPage,e,this.orden)}deleteItem(e){return this.userService.deleteUser(e)}itemAction(e){console.log(e),"delete"===e.action&&this.deleteItem(e.element.id).pipe(Object(c.a)(1)).subscribe(e=>console.log(e)),"edit"===e.action&&this.router.navigate(["/usuarios/usuario",e.element.id])}ngOnDestroy(){this.subscroption.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(r.Ob(u.a),r.Ob(a.b))},e.\u0275cmp=r.Ib({type:e,selectors:[["mvd-users"]],viewQuery:function(e,t){var i;1&e&&r.xc(h.a,!0),2&e&&r.pc(i=r.cc())&&(t.paginator=i.first)},decls:26,vars:13,consts:[[1,"card","mat-elevation-z16","animate__animated","animate__slideInRight"],[1,"actions"],["mat-flat-button","","routerLink","/usuarios/usuario","color","primary"],[1,"material-icons-round"],["mat-flat-button","","routerLink","/","color","",1,"btn-simple"],[3,"noteFilterBy","changeSearch"],[3,"columns","dataSource","actionChange"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[1,"border"]],template:function(e,t){1&e&&(r.Ub(0,"mat-card",0),r.Ub(1,"mat-card-header"),r.Ub(2,"mat-card-title"),r.Dc(3),r.Tb(),r.Ub(4,"mat-card-subtitle"),r.Dc(5),r.Tb(),r.Ub(6,"div",1),r.Ub(7,"button",2),r.Ub(8,"mat-icon",3),r.Dc(9,"add"),r.Tb(),r.Dc(10," Crear "),r.Tb(),r.Ub(11,"button",4),r.Ub(12,"mat-icon",3),r.Dc(13,"print"),r.Tb(),r.Dc(14," Imprimir "),r.Tb(),r.Ub(15,"button",4),r.Ub(16,"mat-icon",3),r.Dc(17,"save_alt"),r.Tb(),r.Dc(18," Exportar "),r.Tb(),r.Tb(),r.Ub(19,"mvd-input-search",5),r.bc("changeSearch",(function(e){return t.search(e)})),r.Tb(),r.Tb(),r.Ub(20,"mat-card-content"),r.Ub(21,"mvd-data-table",6),r.bc("actionChange",(function(e){return t.itemAction(e)})),r.gc(22,"async"),r.Tb(),r.Ub(23,"mat-paginator",7),r.bc("page",(function(e){return t.paginatorChange(e)})),r.gc(24,"async"),r.Tb(),r.Tb(),r.Pb(25,"span",8),r.Tb()),2&e&&(r.Cb(3),r.Ec(t.title),r.Cb(2),r.Fc("Administrar ",t.title,""),r.Cb(14),r.lc("noteFilterBy","Filtra por nombre, email, direcci\xf3n, tel\xe9fonos, documento, empresa o CUIT"),r.Cb(2),r.lc("columns",t.columns)("dataSource",r.hc(22,8,t.dataSource)),r.Cb(2),r.lc("length",r.hc(24,10,t.totalResut))("pageSize",t.perPage)("pageSizeOptions",r.mc(12,k)))},directives:[n.a,n.c,n.f,n.e,C.b,a.c,T.a,D.a,n.b,S.a,h.a],pipes:[s.b],styles:[""]}),e})()}];let N=(()=>{class e{}return e.\u0275mod=r.Mb({type:e}),e.\u0275inj=r.Lb({factory:function(t){return new(t||e)},imports:[[a.f.forChild(B)],a.f]}),e})();var R=i("PCNd");let A=(()=>{class e{}return e.\u0275mod=r.Mb({type:e}),e.\u0275inj=r.Lb({factory:function(t){return new(t||e)},imports:[[s.c,N,R.a]]}),e})()},XpUC:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var s=i("AytR"),a=i("lJxs"),r=i("fXoL"),n=i("tk/3");let o=(()=>{class e{constructor(e){this.http=e}getCurrencies(){return this.http.get(`${s.a.API}${s.a.routesCRUD.currencies}`).pipe(Object(a.a)(e=>e.data))}}return e.\u0275fac=function(t){return new(t||e)(r.Yb(n.b))},e.\u0275prov=r.Kb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}]);